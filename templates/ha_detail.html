{% extends 'base_detail.html' %}
{% block content %}
<div class="container p-3 my-2 border">
    <!-- ha_detail çš„ä¸“å±åŠŸèƒ½-->
    <h2>
        <mark>
            {% if current_user.is_authenticated %}
            æŒ‰æç¤ºè¾“å…¥å³å¯æŸ¥è¯¢ï¼š
            {% else %}
            æ‚¨æœªç™»å½•ï¼Œè¯·å…ˆğŸ‘†ç™»å½•ğŸ‘†æˆ–ğŸ‘†æ³¨å†ŒğŸ‘†ï¼Œå¦åˆ™åªèƒ½ä½¿ç”¨<B>â€œè®¡ç®—â€</B>åŠŸèƒ½ã€‚
            {% endif %}
        </mark>
    </h2>
    <div align="center">
        <!-- åœ¨æ¨¡æ¿ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ current_user å˜é‡ã€‚ä»¥åˆ›å»ºæ–°æ¡ç›®è¡¨å•ä¸ºä¾‹ï¼Œæˆ‘ä»¬åœ¨è¡¨å•å¤–éƒ¨æ·»åŠ ä¸€ä¸ª if åˆ¤æ–­ï¼š
                åœ¨æ¨¡æ¿æ¸²æŸ“æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­å½“å‰ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼ˆcurrent_user.is_authenticatedï¼‰ã€‚
                    å¦‚æœç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼ˆcurrent_user.is_authenticated è¿”å› Falseï¼‰ï¼Œ
                    å°±ä¸ä¼šæ¸²æŸ“å¦‚ä¸‹ä»£ç å—ï¼Œå³è¡¨å• <form method="POST" name="form">...</form> éƒ¨åˆ†çš„ HTML ä»£ç  -->
        {% if current_user.is_authenticated %}
        <form method="POST" action="ha_detail" name="form_fuzzy_inquiry_name_area">
            <!-- æ¨¡ç³ŠæŸ¥è¯¢åŠŸèƒ½ -->
            <h3>è¾“å…¥åœ°åŒºåä»¥â€œæ¨¡ç³ŠæŸ¥è¯¢â€ï¼Œä¼šæ˜¾ç¤ºâ€œæ£‰é“ƒè™«ä¿¡æ¯è®°å½•è¡¨â€</h3>
            <input type="text" name="fuzzy_inquiry_name_area" placeholder="å¯è¾“å…¥æ¨¡ç³Šå­—ï¼Œå¦‚â€œä¼Šâ€" autocomplete="off">
            <!-- æ–‡æœ¬è¾“å…¥æ¡† -->
            <input type="submit" name="submit" value="ğŸ‘‰æŸ¥è¯¢ğŸ‘ˆ" class="btn" /><!-- æäº¤æŒ‰é’® --><br>
            <small>ï¼ˆå¦‚æœä¸è¾“å…¥ï¼Œç›´æ¥ç‚¹å‡»ğŸ‘‰æŸ¥è¯¢ğŸ‘ˆä¼šæ˜¾ç¤ºæ‰€æœ‰è®°å½•ï¼‰</small><br>
        </form>
        {% else %}
        æ‚¨æœªç™»å½•ï¼Œåªæœ‰ä¸‹é¢è¿™ä¸ªåŠŸèƒ½äº†ï¼š<br>
        <form method="POST" action="/" name="form">
            <!-- æŒ‡å®šæäº¤æ–¹æ³•ä¸º POST -->
            ç¬¬ä¸€ä»£æ£‰é“ƒè™«æ•°é‡(å¤´/ç™¾æ ª)
            <input type="text" name="x1" placeholder="è¾“å…¥ X1ï¼ˆæ•°å€¼ï¼‰" autocomplete="off" required><!-- æ–‡æœ¬è¾“å…¥æ¡† -->
            <br>
            ç¬¬äºŒä»£æ£‰é“ƒè™«æ•°é‡(å¤´/ç™¾æ ª)
            <input type="text" name="x2" placeholder="è¾“å…¥ X2ï¼ˆæ•°å€¼ï¼‰" autocomplete="off" required><!-- æ–‡æœ¬è¾“å…¥æ¡† -->
            <br>
            <input type="submit" name="submit" value="ğŸ‘‰è®¡ç®—ğŸ‘ˆ" class="btn" /><br><!-- æäº¤æŒ‰é’® -->
            äº§é‡æŸå¤±ç‡(%)
            <input type="text" name="result" placeholder="å¾—å‡º Yï¼ˆæ•°å€¼ï¼‰" readonly="readonly" value="{{ RESULT_visitor }}" />
            <br>
        </form>
        {% endif %}{# æ¨¡æ¿å†…å®¹ä¿æŠ¤ #}
    </div>
    <!-- åœ¨è¿™é€è¡Œè¾“å‡º æ£‰é“ƒè™«ä¿¡æ¯(ha_info) çš„è®°å½• -->
    <div align="right">
        {# ä½¿ç”¨ length è¿‡æ»¤å™¨è·å– list_ha å˜é‡çš„é•¿åº¦ #}
        {# {{ å˜é‡|è¿‡æ»¤å™¨ }} #}
        <!--æœ‰èŠ±æ‹¬å·ä¸èƒ½ç”¨è¿™ç§æ³¨é‡Š-->
        å·²æœ‰ {{ list_ha | length }} æ¡è®°å½•ã€‚&emsp;
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('index') }}">è¿”å›ä¸»é¡µ</a>
        {% endif %}{# æ¨¡æ¿å†…å®¹ä¿æŠ¤ #}
    </div>
    {% if current_user.is_authenticated %}
    <div class="container mt-3">
        <div class="table-responsive-lg">
            <table class="table table-striped table-hover ">
                <thead class="table-bordered table-success">
                    <tr>
                        <th>ç¼–å·(id)</th>
                        <th>X1(å¤´/ç™¾æ ª)</th>
                        <th>X2(å¤´/ç™¾æ ª)</th>
                        <th>Y(%)</th>
                        <th><mark>è°ƒæŸ¥åœ°åŒº</mark></th>
                        <th>è°ƒæŸ¥æ—¥æœŸ(å¹´-æœˆ-æ—¥)</th>
                        <th>è°ƒæŸ¥äººçš„â€œç§°å‘¼â€</th>
                        <th>æ“ä½œæŒ‰é’®</th>
                    </tr>
                <tbody>
                    {% for row_ha in list_ha %} {# è¿­ä»£ list_ha å˜é‡ #}
                    {# æˆ‘éœ€è¦åœ¨ä¸‹é¢å†™å…¥ if ç­›é€‰ #}
                    {% if  Area_info.query.filter_by(id_area=row_ha.id_area).first().name_area in  list_area_name_area %}
                    <tr>
                        <td>
                            {{ row_ha.id_ha | int }}
                        </td>
                        <td>
                            <code>{{ row_ha.x1 | round(1, 'floor') }}</code>
                        </td>
                        <td>
                            <code>{{ row_ha.x2 | round(1, 'floor') }}</code>
                        </td>
                        <td>
                            <code>{{ row_ha.y | round(2, 'floor') }}</code>
                        </td>
                        <td>
                            <code>{{ Area_info.query.filter_by(id_area=row_ha.id_area).first().name_area }}</code>
                        </td>
                        <td>
                            <code>{{ row_ha.date }}{# ç­‰åŒäº row_ha['x1'] #}</code>
                        </td>
                        <td>
                            <code>{{ User_info.query.filter_by(id_user=row_ha.id_user).first().name_user }}</code>
                        </td>
                        <td class="table-info">
                            <!-- <span class="float-right"> -->
                            {% if current_user.is_authenticated %}
                            <a class="btn" href="{{ url_for('edit', id_ha=row_ha.id_ha) }}">ç¼–è¾‘</a>
                            <form class="inline-form" method="post"
                                action="{{ url_for('delete', id_ha=row_ha.id_ha) }}">
                                <input class="btn" type="submit" name="delete" value="åˆ é™¤"
                                    onclick="return confirm('æ‚¨ç¡®å®šåˆ é™¤å—ï¼Ÿ')">
                            </form>
                            {% endif %}{# æ¨¡æ¿å†…å®¹ä¿æŠ¤ #}
                            <!-- </span> -->
                        </td>
                    </tr>
                    {% endif %}
                    {% endfor %} {# ä½¿ç”¨ endfor æ ‡ç­¾ç»“æŸ for è¯­å¥ #}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}{# æ¨¡æ¿å†…å®¹ä¿æŠ¤ #}
</div>
{% endblock %}